

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>一、基础知识 &mdash; KaliArch SHELL BLOG 1.0.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to MING’s BLOG’s documentation!" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> KaliArch SHELL BLOG
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">一、基础知识</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#shell">一、Shell简介</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">二、Shell分类</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#shell-gui-shell">2.1 图形界面 Shell（GUI Shell）</a></li>
<li class="toctree-l3"><a class="reference internal" href="#shell-cli-shell">2.2 命令行界面 Shell（CLI Shell）</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">三、第一个Shell</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">四、执行Shell的三种方法</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bash">4.1 直接bash执行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">4.2 ./执行</a></li>
<li class="toctree-l3"><a class="reference internal" href="#source">4.3 source执行</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id6">五、Shell变量</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id7">5.1 变量命名规则：</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">5.2 系统内置变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">5.3 用户自定义变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">5.4 变量引用</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id11">六、引号</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id12">七、注释</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id13">二、字符串与数组</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id14">一、字符串常用操作</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id15">1.1 获取字符串长度</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">1.2 字符串切片</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id17">1.3 字符串替换</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id18">1.4 字符串截取</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id19">1.5 变量状态赋值</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id20">二、数组</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id21">2.1 数组定义</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id22">2.2 数组元素读取</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id23">三、字符显示颜色</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id24">三、运算符</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id25">一、Shell表达式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id26">1.1 整数比较符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">1.2 算术运算符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id28">1.3 布尔运算符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id29">1.4 逻辑运算符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id30">1.5 文件测试运算符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id31">1.6 字符串测试</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id32">四、流程控制</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#if">一、if语句</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id33">1.1 单分支</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id34">1.2 双分支</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id35">1.3 多分支</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#for">二、for循环</a></li>
<li class="toctree-l2"><a class="reference internal" href="#while">三、while语句</a></li>
<li class="toctree-l2"><a class="reference internal" href="#break-continue">四、break 和 continue 语句</a></li>
<li class="toctree-l2"><a class="reference internal" href="#case">五、case语句</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id36">五、函数</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id37">一、概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id38">二、格式</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id39">三、函数参数</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id42">六、正则表达式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id43">一、基本正则表达式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id44">1.1 字符匹配</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id45">1.2 次数匹配</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id46">1.3 位置锚定</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id47">1.4 分组引用</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#grep">七、三剑客之grep</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id48">一、概念</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id50">二、语法格式</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id51">2.1 选项</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#sed">八、三剑客之sed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id53">一、概念：</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id55">三、语法</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#awk">九、三剑客之awk</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id56">一、概念</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id58">1.1 awk输出</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id59">1.2 awk变量</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id60">1.3 操作符</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pattern">1.4 Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="#action">1.5 常用action</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id63">1.6 控制语句</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#array">1.6 array</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id64">1.7 函数</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#id65">十、shell杂项</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id66">一、输入输出</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id67">命令</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">KaliArch SHELL BLOG</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>一、基础知识</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/myshell-note.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#id1" id="id70">一、基础知识</a><ul>
<li><a class="reference internal" href="#shell" id="id71">一、Shell简介</a></li>
<li><a class="reference internal" href="#id2" id="id72">二、Shell分类</a><ul>
<li><a class="reference internal" href="#shell-gui-shell" id="id73">2.1 图形界面 Shell（GUI Shell）</a></li>
<li><a class="reference internal" href="#shell-cli-shell" id="id74">2.2 命令行界面 Shell（CLI Shell）</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id3" id="id75">三、第一个Shell</a></li>
<li><a class="reference internal" href="#id4" id="id76">四、执行Shell的三种方法</a><ul>
<li><a class="reference internal" href="#bash" id="id77">4.1 直接bash执行</a></li>
<li><a class="reference internal" href="#id5" id="id78">4.2 ./执行</a></li>
<li><a class="reference internal" href="#source" id="id79">4.3 source执行</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id6" id="id80">五、Shell变量</a><ul>
<li><a class="reference internal" href="#id7" id="id81">5.1 变量命名规则：</a></li>
<li><a class="reference internal" href="#id8" id="id82">5.2 系统内置变量</a></li>
<li><a class="reference internal" href="#id9" id="id83">5.3 用户自定义变量</a></li>
<li><a class="reference internal" href="#id10" id="id84">5.4 变量引用</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id11" id="id85">六、引号</a></li>
<li><a class="reference internal" href="#id12" id="id86">七、注释</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id13" id="id87">二、字符串与数组</a><ul>
<li><a class="reference internal" href="#id14" id="id88">一、字符串常用操作</a><ul>
<li><a class="reference internal" href="#id15" id="id89">1.1 获取字符串长度</a></li>
<li><a class="reference internal" href="#id16" id="id90">1.2 字符串切片</a></li>
<li><a class="reference internal" href="#id17" id="id91">1.3 字符串替换</a></li>
<li><a class="reference internal" href="#id18" id="id92">1.4 字符串截取</a></li>
<li><a class="reference internal" href="#id19" id="id93">1.5 变量状态赋值</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id20" id="id94">二、数组</a><ul>
<li><a class="reference internal" href="#id21" id="id95">2.1 数组定义</a></li>
<li><a class="reference internal" href="#id22" id="id96">2.2 数组元素读取</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id23" id="id97">三、字符显示颜色</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id24" id="id98">三、运算符</a><ul>
<li><a class="reference internal" href="#id25" id="id99">一、Shell表达式</a><ul>
<li><a class="reference internal" href="#id26" id="id100">1.1 整数比较符</a></li>
<li><a class="reference internal" href="#id27" id="id101">1.2 算术运算符</a></li>
<li><a class="reference internal" href="#id28" id="id102">1.3 布尔运算符</a></li>
<li><a class="reference internal" href="#id29" id="id103">1.4 逻辑运算符</a></li>
<li><a class="reference internal" href="#id30" id="id104">1.5 文件测试运算符</a></li>
<li><a class="reference internal" href="#id31" id="id105">1.6 字符串测试</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id32" id="id106">四、流程控制</a><ul>
<li><a class="reference internal" href="#if" id="id107">一、if语句</a><ul>
<li><a class="reference internal" href="#id33" id="id108">1.1 单分支</a></li>
<li><a class="reference internal" href="#id34" id="id109">1.2 双分支</a></li>
<li><a class="reference internal" href="#id35" id="id110">1.3 多分支</a></li>
</ul>
</li>
<li><a class="reference internal" href="#for" id="id111">二、for循环</a></li>
<li><a class="reference internal" href="#while" id="id112">三、while语句</a></li>
<li><a class="reference internal" href="#break-continue" id="id113">四、break 和 continue 语句</a></li>
<li><a class="reference internal" href="#case" id="id114">五、case语句</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id36" id="id115">五、函数</a><ul>
<li><a class="reference internal" href="#id37" id="id116">一、概念</a></li>
<li><a class="reference internal" href="#id38" id="id117">二、格式</a></li>
<li><a class="reference internal" href="#id39" id="id118">三、函数参数</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id42" id="id119">六、正则表达式</a><ul>
<li><a class="reference internal" href="#id43" id="id120">一、基本正则表达式</a><ul>
<li><a class="reference internal" href="#id44" id="id121">1.1 字符匹配</a></li>
<li><a class="reference internal" href="#id45" id="id122">1.2 次数匹配</a></li>
<li><a class="reference internal" href="#id46" id="id123">1.3 位置锚定</a></li>
<li><a class="reference internal" href="#id47" id="id124">1.4 分组引用</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#grep" id="id125">七、三剑客之grep</a><ul>
<li><a class="reference internal" href="#id48" id="id126">一、概念</a></li>
<li><a class="reference internal" href="#id50" id="id127">二、语法格式</a><ul>
<li><a class="reference internal" href="#id51" id="id128">2.1 选项</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#sed" id="id129">八、三剑客之sed</a><ul>
<li><a class="reference internal" href="#id53" id="id130">一、概念：</a></li>
<li><a class="reference internal" href="#id55" id="id131">三、语法</a></li>
</ul>
</li>
<li><a class="reference internal" href="#awk" id="id132">九、三剑客之awk</a><ul>
<li><a class="reference internal" href="#id56" id="id133">一、概念</a><ul>
<li><a class="reference internal" href="#id58" id="id134">1.1 awk输出</a></li>
<li><a class="reference internal" href="#id59" id="id135">1.2 awk变量</a></li>
<li><a class="reference internal" href="#id60" id="id136">1.3 操作符</a></li>
<li><a class="reference internal" href="#pattern" id="id137">1.4 Pattern</a></li>
<li><a class="reference internal" href="#action" id="id138">1.5 常用action</a></li>
<li><a class="reference internal" href="#id63" id="id139">1.6 控制语句</a></li>
<li><a class="reference internal" href="#id64" id="id140">1.7 函数</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#id65" id="id141">十、shell杂项</a><ul>
<li><a class="reference internal" href="#id66" id="id142">一、输入输出</a></li>
<li><a class="reference internal" href="#id67" id="id143">命令</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id1">
<h1><a class="toc-backref" href="#id70">一、基础知识</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="shell">
<h2><a class="toc-backref" href="#id71">一、Shell简介</a><a class="headerlink" href="#shell" title="Permalink to this headline">¶</a></h2>
<p>Shell 是一个 C 语言编写的脚本语言，它是用户与 Linux
的桥梁，用户输入命令交给 Shell 处理， Shell
将相应的操作传递给内核（Kernel），内核把处理的结果输出给用户。</p>
<p>程序=指令+数据</p>
</div>
<div class="section" id="id2">
<h2><a class="toc-backref" href="#id72">二、Shell分类</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="shell-gui-shell">
<h3><a class="toc-backref" href="#id73">2.1 图形界面 Shell（GUI Shell）</a><a class="headerlink" href="#shell-gui-shell" title="Permalink to this headline">¶</a></h3>
<p>GUI 为 Unix 或者类 Unix
操作系统构造一个功能完善、操作简单以及界面友好的桌面环境。主流桌面环境有
KDE，Gnome 等。</p>
</div>
<div class="section" id="shell-cli-shell">
<h3><a class="toc-backref" href="#id74">2.2 命令行界面 Shell（CLI Shell）</a><a class="headerlink" href="#shell-cli-shell" title="Permalink to this headline">¶</a></h3>
<p>CLI
是在用户提示符下键入可执行指令的界面，用户通过键盘输入指令，完成一系列操作。</p>
<p>在 Linux 系统上主流的 CLI 实现是 Bash，是许多 Linux 发行版默认的
Shell。还有许多 Unix 上Shell。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@10</span><span class="o">-</span><span class="mi">234</span><span class="o">-</span><span class="mi">2</span><span class="o">-</span><span class="mi">128</span> <span class="n">pyworkspace</span><span class="p">]</span><span class="c1"># cat /etc/shells</span>
<span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
<span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
</pre></div>
</div>
<p><strong>Shell的分类:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* Bourne Shell（/usr/bin/sh或/bin/sh）
* Bourne Again Shell（/bin/bash）
* C Shell（/usr/bin/csh）
* K Shell（/usr/bin/ksh）
* Shell for Root（/sbin/sh）
</pre></div>
</div>
<p><strong>脚本命名:</strong></p>
<p>注意：见名知意，后缀规范为<code class="docutils literal notranslate"><span class="pre">.sh</span></code></p>
</div>
</div>
<div class="section" id="id3">
<h2><a class="toc-backref" href="#id75">三、第一个Shell</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="n">echo</span> <span class="s2">&quot;this is my first shell script&quot;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">#!</span></code> 告诉系统其后路径所指定的程序即是解释此脚本文件的 Shell 程序
<code class="docutils literal notranslate"><span class="pre">/bin/bash</span></code> 指定使用的是那种shell <code class="docutils literal notranslate"><span class="pre">echo</span></code>在终端打印出内容</p>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id76">四、执行Shell的三种方法</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bash">
<h3><a class="toc-backref" href="#id77">4.1 直接bash执行</a><a class="headerlink" href="#bash" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># ll</span>
<span class="n">total</span> <span class="mi">4</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">44</span> <span class="n">Sep</span>  <span class="mi">3</span> <span class="mi">14</span><span class="p">:</span><span class="mi">16</span> <span class="mi">01</span><span class="o">-</span><span class="n">scripts</span><span class="o">.</span><span class="n">sh</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># cat 01-scripts.sh</span>
<span class="c1">#!/bin/bash</span>

<span class="n">echo</span> <span class="s2">&quot;this is my first script&quot;</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># bash 01-scripts.sh</span>
<span class="n">this</span> <span class="ow">is</span> <span class="n">my</span> <span class="n">first</span> <span class="n">script</span>
</pre></div>
</div>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id78">4.2 ./执行</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># ./01-scripts.sh</span>
<span class="o">-</span><span class="n">bash</span><span class="p">:</span> <span class="o">./</span><span class="mi">01</span><span class="o">-</span><span class="n">scripts</span><span class="o">.</span><span class="n">sh</span><span class="p">:</span> <span class="n">Permission</span> <span class="n">denied</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># chmod +x 01-scripts.sh</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># ll</span>
<span class="n">total</span> <span class="mi">4</span>
<span class="o">-</span><span class="n">rwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span> <span class="mi">1</span> <span class="n">root</span> <span class="n">root</span> <span class="mi">44</span> <span class="n">Sep</span>  <span class="mi">3</span> <span class="mi">14</span><span class="p">:</span><span class="mi">16</span> <span class="mi">01</span><span class="o">-</span><span class="n">scripts</span><span class="o">.</span><span class="n">sh</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># ./01-scripts.sh</span>
<span class="n">this</span> <span class="ow">is</span> <span class="n">my</span> <span class="n">first</span> <span class="n">script</span>
</pre></div>
</div>
<p>这种方式默认根据脚本第一行指定的解释器处理，如果没写以当前默认 Shell
解释器执行。</p>
</div>
<div class="section" id="source">
<h3><a class="toc-backref" href="#id79">4.3 source执行</a><a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># source 01-scripts.sh</span>
<span class="n">this</span> <span class="ow">is</span> <span class="n">my</span> <span class="n">first</span> <span class="n">script</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id6">
<h2><a class="toc-backref" href="#id80">五、Shell变量</a><a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>变量名+内存空间</p>
<p>变量赋值：<code class="docutils literal notranslate"><span class="pre">name=value</span></code></p>
<p>弱类型变量，所有变量类型视为字符串类型，对于数值相加自动转换为数组类型，无需实现声明</p>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id81">5.1 变量命名规则：</a><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>命名只能使用英文字母，数字和下划线，首个字符不能以数字开头。</li>
<li>中间不能有空格，可以使用下划线（_）。</li>
<li>不能使用标点符号。</li>
<li>不能使用bash里的关键字（可用help命令查看保留关键字）</li>
<li>做到见名知意</li>
</ul>
<p>环境变量作用范围：当前shell进程及其子进程</p>
<p>本地变量作用范围：当前shell</p>
<p>局部变量作用范围：代码片段</p>
<p>利用export将本地变量导入到环境，扩大作用范围</p>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id82">5.2 系统内置变量</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>在命令行提示符直接执行<code class="docutils literal notranslate"><span class="pre">env、set</span></code>查看系统或环境变量。<code class="docutils literal notranslate"><span class="pre">env</span></code>
显示用户环境变量，<code class="docutils literal notranslate"><span class="pre">set</span></code> 显示 Shell
预先定义好的变量以及用户变量。可以通过 <code class="docutils literal notranslate"><span class="pre">export</span></code> 导出成用户变量。</p>
<p>还可通过<code class="docutils literal notranslate"><span class="pre">printevn/declare</span> <span class="pre">-x</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$SHELL      默认 Shell

$HOME       当前用户家目录

$IFS        内部字段分隔符

$LANG       默认语言

$PATH       默认可执行程序路径

$PWD        当前目录

$UID        当前用户 ID

$USER       当前用户

$HISTSIZE   历史命令大小，可通过 HISTTIMEFORMAT 变量设置命令执行时间

$RANDOM     随机生成一个 0 至 32767 的整数

$HOSTNAME   主机名
</pre></div>
</div>
<p><strong>特殊变量</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>${1..n} 指定第n个输入的变量名称
$0      脚本自身名字

$?      返回上一条命令是否执行成功，0 为执行成功，非 0 则为执行失败

$#      位置参数总数

$*      所有的位置参数被看做一个字符串

$@      每个位置参数被看做独立的字符串

$$      当前进程 PID

$!      上一条运行后台进程的 PID
</pre></div>
</div>
<p><strong>相同点</strong>：都是引用所有参数。</p>
<p><strong>不同点</strong>：只有在双引号中体现出来。假设在脚本运行时写了三个参数
1、2、3，，则 ” * ” 等价于 “1 2 3”（传递了一个参数），而 “&#64;” 等价于 “1”
“2” “3”（传递了三个参数）。</p>
<p>profile 类型： * 定义全局变量 * 运行命令或脚本</p>
<p>bashrc 类型： * 定义本地变量 * 定义命令别名</p>
<p>交互式登录shell： 加载顺序：/etc/profile -&gt; /etc/profile.d/* -&gt;
~/.bash_profile -&gt; ~/.bashrc -&gt; /etc/bashrc</p>
<p>非交互式登录shell： 加载顺序：~/.bashrc -&gt; /etc/bashrc -&gt;
/etc/profile.d/*</p>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id83">5.3 用户自定义变量</a><a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>普通变量</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># var=normal</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># echo $var</span>
<span class="n">normal</span>
</pre></div>
</div>
<ul class="simple">
<li>临时环境变量</li>
</ul>
<p>在当前shell下定义的变量，只对当前shell有效，新的bash已经其子bash无法使用当前定义的shell，如果在本shell存在的情况下，使用<code class="docutils literal notranslate"><span class="pre">export</span></code>来导入到系统变量中，如果当前shell终端终端，那么导入的变量将全部失效，永久生效需要写入linux配置文件中。</p>
<ul class="simple">
<li>只读变量</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># var=&#39;test&#39;</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo $var</span>
<span class="n">test</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># readonly var</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># var=&#39;bbb&#39;</span>
<span class="o">-</span><span class="n">bash</span><span class="p">:</span> <span class="n">var</span><span class="p">:</span> <span class="n">readonly</span> <span class="n">variable</span>
</pre></div>
</div>
<ul class="simple">
<li>删除变量</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">unset</span> <span class="pre">variable_name</span></code></p>
<p>变量被删除后不能再次使用。unset 命令不能删除只读变量。</p>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id84">5.4 变量引用</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>= 变量赋值</li>
<li>+= 变量相加</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">data</span><span class="p">]</span><span class="c1"># var=123</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">data</span><span class="p">]</span><span class="c1"># var+=234</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@shell</span> <span class="n">data</span><span class="p">]</span><span class="c1"># echo $var</span>
<span class="mi">123234</span>
</pre></div>
</div>
<p>为避免特殊字符及变量与字符连接使用，建议引用变量添加大括号</p>
</div>
</div>
<div class="section" id="id11">
<h2><a class="toc-backref" href="#id85">六、引号</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>单引号是告诉 Shell
忽略特殊字符，而双引号则解释特殊符号原有的意义，比如$、！。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[root@xuel-tmp-shell www]# var1=&quot;aaa&quot;
[root@xuel-tmp-shell www]# echo &#39;$var1&#39;
$var1
[root@xuel-tmp-shell www]# echo &quot;$var1&quot;
aaa
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[root@xuel-tmp-shell www]# var2=&quot;aa&quot;
[root@xuel-tmp-shell www]# var3=&#39;bb $var2&#39;
[root@xuel-tmp-shell www]# echo $var3
bb $var2
[root@xuel-tmp-shell www]# var4=&quot;bb $var2&quot;
[root@xuel-tmp-shell www]# echo $var4
bb aa
</pre></div>
</div>
</div>
<div class="section" id="id12">
<h2><a class="toc-backref" href="#id86">七、注释</a><a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>单行注释使用<code class="docutils literal notranslate"><span class="pre">#</span></code></li>
<li>多行注释固定函数格式</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:</span><span class="o">&lt;&lt;</span><span class="n">EOF</span>
<span class="n">内容</span><span class="o">...</span>
<span class="n">内容</span><span class="o">...</span>
<span class="n">EOF</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id13">
<h1><a class="toc-backref" href="#id87">二、字符串与数组</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id14">
<h2><a class="toc-backref" href="#id88">一、字符串常用操作</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id15">
<h3><a class="toc-backref" href="#id89">1.1 获取字符串长度</a><a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>利用<code class="docutils literal notranslate"><span class="pre">${#var}</span></code>来获取字符串长度</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># var=&#39;abcstring&#39;</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${#var}</span>
<span class="mi">9</span>
</pre></div>
</div>
</div>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id90">1.2 字符串切片</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>格式：</p>
<p>${parameter:offset} ${parameter:offset:length}</p>
<p>截取从 offset 个字符开始，向后 length 个字符。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># var=&quot;hello shell&quot;</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var:0}</span>
<span class="n">hello</span> <span class="n">shell</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var:0:5}</span>
<span class="n">hello</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var:6:5}</span>
<span class="n">shell</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var:(-1)}</span>
<span class="n">l</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var:(-2)}</span>
<span class="n">ll</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var:(-5):2}</span>
<span class="n">sh</span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<h3><a class="toc-backref" href="#id91">1.3 字符串替换</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>格式：${parameter/pattern/string}</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># var=&quot;hello shell&quot;</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${var/shell/world}</span>
<span class="n">hello</span> <span class="n">world</span>
</pre></div>
</div>
</div>
<div class="section" id="id18">
<h3><a class="toc-backref" href="#id92">1.4 字符串截取</a><a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<p>格式：</p>
<p>${parameter#word} # 删除匹配前缀</p>
<p>${parameter##word}</p>
<p>${parameter%word} # 删除匹配后缀</p>
<p>${parameter%%word}</p>
<p># 去掉左边，最短匹配模式，##最长匹配模式。</p>
<p>% 去掉右边，最短匹配模式，%%最长匹配模式。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># url=&quot;https://www.baidu.com/index.html&quot;</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${url#*/}</span>
<span class="o">/</span><span class="n">www</span><span class="o">.</span><span class="n">baidu</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">html</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${url##*/}</span>
<span class="n">index</span><span class="o">.</span><span class="n">html</span>

<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${url%/*}</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">baidu</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${url%%/*}</span>
<span class="n">https</span><span class="p">:</span>
</pre></div>
</div>
</div>
<div class="section" id="id19">
<h3><a class="toc-backref" href="#id93">1.5 变量状态赋值</a><a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<p>${VAR:-string} 如果 VAR 变量为空则返回 string</p>
<p>${VAR:+string} 如果 VAR 变量不为空则返回 string</p>
<p>${VAR:=string} 如果 VAR 变量为空则重新赋值 VAR 变量值为 string</p>
<p>${VAR:?string} 如果 VAR 变量为空则将 string 输出到 stderr</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[root@xuel-tmp-shell ~]# url=&quot;https://www.baidu.com/index.html&quot;
[root@xuel-tmp-shell ~]# echo ${url:-&quot;string&quot;}
https://www.baidu.com/index.html
[root@xuel-tmp-shell ~]# echo ${url:+&quot;string&quot;}
string
[root@xuel-tmp-shell ~]# unset url
[root@xuel-tmp-shell ~]# echo $url

[root@xuel-tmp-shell ~]# echo ${url:-&quot;string&quot;}
string
[root@xuel-tmp-shell ~]# echo ${url:+&quot;string&quot;}


找出/etc/group下的所有组名称
for i in `cat /etc/group`;do echo ${i%%:*};done
</pre></div>
</div>
</div>
</div>
<div class="section" id="id20">
<h2><a class="toc-backref" href="#id94">二、数组</a><a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h2>
<p>bash支持一维数组（不支持多维数组），并且没有限定数组的大小。数组是相同类型的元素按一定顺序排列的集合。
类似与 C 语言，数组元素的下标由 0
开始编号。获取数组中的元素要利用下标，下标可以是整数或算术表达式，其值应大于或等于
0。</p>
<div class="section" id="id21">
<h3><a class="toc-backref" href="#id95">2.1 数组定义</a><a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<p>在 Shell 中，用括号来表示数组，数组元素用“空格”符号分割开</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># args1=(aa bb cc 1123)</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo $args1</span>
<span class="n">aa</span>

<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${args1[@]}</span>
<span class="n">aa</span> <span class="n">bb</span> <span class="n">cc</span> <span class="mi">1123</span>
</pre></div>
</div>
</div>
<div class="section" id="id22">
<h3><a class="toc-backref" href="#id96">2.2 数组元素读取</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># args1=(aa bb cc 1123)</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${#args1[@]}     #获取数组元素个数</span>
<span class="mi">4</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${args1[0]}</span>
<span class="n">aa</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@xuel</span><span class="o">-</span><span class="n">tmp</span><span class="o">-</span><span class="n">shell</span> <span class="o">~</span><span class="p">]</span><span class="c1"># echo ${args1[1]}</span>
<span class="n">bb</span>

<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># filelist=($(ls))</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># echo ${filelist[*]}</span>
<span class="n">check_url_for</span><span class="o">.</span><span class="n">sh</span> <span class="n">check_url_while01</span><span class="o">.</span><span class="n">sh</span> <span class="n">check_url_while02</span><span class="o">.</span><span class="n">sh</span> <span class="n">func01</span><span class="o">.</span><span class="n">sh</span> <span class="n">func02</span><span class="o">.</span><span class="n">sh</span> <span class="n">func03</span><span class="o">.</span><span class="n">sh</span> <span class="n">urllist</span><span class="o">.</span><span class="n">txt</span>

<span class="n">获取数组元素的下标</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="n">workspace</span><span class="p">]</span><span class="c1"># echo ${!filelist[@]}</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span>
</pre></div>
</div>
<p>遍历文件</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>filelist=($(ls));for i in ${!filelist[@]};do echo ${filelist[$i]};done
</pre></div>
</div>
</div>
</div>
<div class="section" id="id23">
<h2><a class="toc-backref" href="#id97">三、字符显示颜色</a><a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">字体颜色</th>
<th class="head">字体背景颜色</th>
<th class="head">显示方式</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>30：黑</td>
<td>40：黑</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>31：红</td>
<td>41：深红</td>
<td>0：终端默认设置</td>
</tr>
<tr class="row-even"><td>32：绿</td>
<td>42：绿</td>
<td>1：高亮显示</td>
</tr>
<tr class="row-odd"><td>33：黄</td>
<td>43：黄色</td>
<td>4：下划线</td>
</tr>
<tr class="row-even"><td>34：蓝色</td>
<td>44：蓝色</td>
<td>5：闪烁</td>
</tr>
<tr class="row-odd"><td>35：紫色</td>
<td>45：紫色</td>
<td>7：反白显示</td>
</tr>
<tr class="row-even"><td>36：深绿</td>
<td>46：深绿</td>
<td>8：隐藏</td>
</tr>
<tr class="row-odd"><td>37：白色</td>
<td>47：白色</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>格式：</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>\033[1;31;40m</td>
<td># 1
是显示方式，可选。31
是字体颜色。40m
是字体背景颜色。</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>\033[0m</td>
<td colspan="2">#                     |
恢复终端默认颜色，即取消颜色设置。 |</td>
</tr>
</tbody>
</table>
<ul class="simple">
<li>显示方式</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">{</span><span class="mf">1.</span><span class="o">.</span><span class="mi">8</span><span class="p">};</span><span class="n">do</span> <span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[$i;31;40m hello world </span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">;</span><span class="n">done</span>
</pre></div>
</div>
<ul class="simple">
<li>字体颜色</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">{</span><span class="mf">30.</span><span class="o">.</span><span class="mi">37</span><span class="p">};</span><span class="n">do</span> <span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[$i;40m hello world </span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">;</span><span class="n">done</span>
</pre></div>
</div>
<ul class="simple">
<li>背景颜色</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">{</span><span class="mf">40.</span><span class="o">.</span><span class="mi">47</span><span class="p">};</span><span class="n">do</span> <span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;</span><span class="se">\033</span><span class="s2">[47;$</span><span class="si">{i}</span><span class="s2">m hello world! </span><span class="se">\033</span><span class="s2">[0m&quot;</span><span class="p">;</span><span class="n">done</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id24">
<h1><a class="toc-backref" href="#id98">三、运算符</a><a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id25">
<h2><a class="toc-backref" href="#id99">一、Shell表达式</a><a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id26">
<h3><a class="toc-backref" href="#id100">1.1 整数比较符</a><a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="41%" />
<col width="21%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">比较符</th>
<th class="head">描述</th>
<th class="head">示例</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>-eq，equal</td>
<td>等于</td>
<td>[ 1 -eq 1 ]为 true</td>
</tr>
<tr class="row-odd"><td>-ne，not equal</td>
<td>不等于</td>
<td>[ 1 -ne 1 ]为 false</td>
</tr>
<tr class="row-even"><td>-gt，greater than</td>
<td>大于</td>
<td>[ 2 -gt 1 ]为 true</td>
</tr>
<tr class="row-odd"><td>-lt，lesser than</td>
<td>小于</td>
<td>[ 2 -lt 1 ]为 false</td>
</tr>
<tr class="row-even"><td>-ge，greater or equal</td>
<td>大于或等于</td>
<td>[ 2 -ge 1 ]为 true</td>
</tr>
<tr class="row-odd"><td>-le，lesser or equal</td>
<td>小于或等于</td>
<td>[ 2 -le 1 ]为 false</td>
</tr>
</tbody>
</table>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 1 -gt 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">false</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 1 -ne 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">false</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 1 -eq 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">true</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 1 -ne 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">false</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 1 -gt 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">false</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 2 -gt 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">true</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 2 -lt 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">false</span>
<span class="p">[</span><span class="n">root</span><span class="nd">@monitor</span> <span class="o">~</span><span class="p">]</span><span class="c1"># [ 2 -le 1 ] &amp;&amp; echo true || echo false</span>
<span class="n">false</span>
</pre></div>
</div>
</div>
<div class="section" id="id27">
<h3><a class="toc-backref" href="#id101">1.2 算术运算符</a><a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<p>假定变量 a 为 10，变量 b 为 20： 注意：运算符两边有空格</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>A=3
B=6
1、let 算术运算表达式
let C=$A+$B
2、$[算术运算表达式]
C=$[$A+$B]
3、$((算术运算表达式))
C=$(($A+$B))
4、expr 算术运算表达式，表达式中各操作数及运算符之间要有空格，而且要使用命令引用
C=`expr $A + $B`
</pre></div>
</div>
</div>
<div class="section" id="id28">
<h3><a class="toc-backref" href="#id102">1.3 布尔运算符</a><a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id29">
<h3><a class="toc-backref" href="#id103">1.4 逻辑运算符</a><a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="13%" />
<col width="19%" />
<col width="69%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">运算符</th>
<th class="head">说明</th>
<th class="head">举例</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>&amp;&amp;</td>
<td>逻辑的 AND</td>
<td>[[ $a -lt 100 &amp;&amp; $b -gt 100 ]] 返回 false</td>
</tr>
<tr class="row-odd"><td>||</td>
<td>逻辑的 OR</td>
<td>[[ $a -lt 100 || $b -gt 100 ]] 返回 true</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id30">
<h3><a class="toc-backref" href="#id104">1.5 文件测试运算符</a><a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
</div>
<div class="section" id="id31">
<h3><a class="toc-backref" href="#id105">1.6 字符串测试</a><a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h3>
<p>假定变量 a 为 “abc”，变量 b 为 “efg”：</p>
</div>
</div>
</div>
<div class="section" id="id32">
<h1><a class="toc-backref" href="#id106">四、流程控制</a><a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h1>
<div class="section" id="if">
<h2><a class="toc-backref" href="#id107">一、if语句</a><a class="headerlink" href="#if" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id33">
<h3><a class="toc-backref" href="#id108">1.1 单分支</a><a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">condition</span>
<span class="n">then</span>
    <span class="n">command1</span>
    <span class="n">command2</span>
    <span class="o">...</span>
    <span class="n">commandN</span>
<span class="n">fi</span>
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if [ `ps -ef |grep /usr/sbin/sshd|grep -v grep|wc -l` -eq 1 ];then echo &quot;sshd server exist&quot;;fi
</pre></div>
</div>
</div>
<div class="section" id="id34">
<h3><a class="toc-backref" href="#id109">1.2 双分支</a><a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">condition</span>
<span class="n">then</span>
    <span class="n">command1</span>
    <span class="n">command2</span>
    <span class="o">...</span>
    <span class="n">commandN</span>
<span class="k">else</span>
    <span class="n">command</span>
<span class="n">fi</span>
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>if [ `ps -ef |grep /usr/sbin/sshd|grep -v grep|wc -l` -eq 0 ];then echo &quot;sshd server exist&quot;;else echo &quot;sshd server not exist&quot;;fi
</pre></div>
</div>
</div>
<div class="section" id="id35">
<h3><a class="toc-backref" href="#id110">1.3 多分支</a><a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">condition1</span>
<span class="n">then</span>
    <span class="n">command1</span>
<span class="k">elif</span> <span class="n">condition2</span>
<span class="n">then</span>
    <span class="n">command2</span>
<span class="k">else</span>
    <span class="n">commandN</span>
<span class="n">fi</span>
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#! /bin/bash

cmd=`rpm -q centos-release|cut -d- -f3`

if [ $cmd -eq 6 ];then
    echo &quot;sysversion is $cmd&quot;
elif [ $cmd -eq 7 ];then
    echo &quot;sysversion is $cmd&quot;
else
    echo &quot;sysversion is `rpm -q centos-release`&quot;
fi
</pre></div>
</div>
</div>
</div>
<div class="section" id="for">
<h2><a class="toc-backref" href="#id111">二、for循环</a><a class="headerlink" href="#for" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">item1</span> <span class="n">item2</span> <span class="o">...</span> <span class="n">itemN</span>
<span class="n">do</span>
    <span class="n">command1</span>
    <span class="n">command2</span>
    <span class="o">...</span>
    <span class="n">commandN</span>
<span class="n">done</span>
</pre></div>
</div>
<p>eg1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>for i in /*;
do
    echo -e &quot;   \c&quot;;
    find $i |wc -l|sort -nr;
done
</pre></div>
</div>
<p>eg2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
for i in {1..3};
do
    echo $i
done
</pre></div>
</div>
<p>eg3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
for i in &quot;$@&quot;; {    # $@是将位置参数作为单个来处理
echo $i
}
</pre></div>
</div>
<p>默认 for 循环的取值列表是以空白符分隔，也就是第一章讲系统变量里的$IFS:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
OLD_IFS=$IFS
IFS=&quot;:&quot;
for i in $(head -1 /etc/passwd); do
echo $i
done
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash

for ip in 192.168.1.{1..254}; do

    if ping -c 1 $ip &gt;/dev/null; then

        echo &quot;$ip OK.&quot;

    else

        echo &quot;$ip NO!&quot;

    fi

done
</pre></div>
</div>
<p>读取文件,判断url可用性</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#function:check url
filename=urllist.txt
for url in $(cat $filename)
do
status=`curl -I $url -s|awk &#39;/HTTP/{print $2}&#39;`
if [ $status == &quot;200&quot; ];then
    echo &quot;Url:$url is ok!status is $status&quot;
else
    echo &quot;Url:$url is error!status is $status&quot;
fi
done
</pre></div>
</div>
</div>
<div class="section" id="while">
<h2><a class="toc-backref" href="#id112">三、while语句</a><a class="headerlink" href="#while" title="Permalink to this headline">¶</a></h2>
<p>格式：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="n">条件表达式</span><span class="p">:</span><span class="n">do</span>
    <span class="n">command</span>
<span class="n">done</span>
</pre></div>
</div>
<p>eg1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
N=0
while [ $N -lt 5 ]; do
let N++
echo $N
done
</pre></div>
</div>
<p>条件表达式为 true，将会产生死循环,利用此可以将脚本一直放在后台进行执行
eg2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
IP=10.75.128.8
dir=&quot;/DATA/oracle/netdir/&quot;
if [ ! -d ${dir} ];then
    mkdir -p ${dir}
fi
echo 1 &gt; ${dir}ping.lock
while true
do
    Time=`date +%F`
    TIME=&quot;${Time} 23:59&quot;
    if [ &quot;${data}&quot; == &quot;${TIME}&quot; ];then
        mkdir ${dir}${Time} &amp;&amp; mv ${dir}ping2.log ${dir}${Time}-ping2.log
        mv ${dir}${Time}-ping2.log ${dir}${Time}
    fi
    find ${dir} -mtime +7 -name &quot;*-ping2.log&quot; -exec rm -rf {} \;
    find ${dir} -mtime +7 -type d -exec rm -rf {} \;

    data=`date +%F&#39; &#39;%H:%M`
    data1=`date +%F&#39; &#39;%H:%M:%S`
    echo &quot;------------${data1}---------------&quot;&gt;&gt;${dir}ping2.log
    ping -c 10 ${IP} &gt;&gt;${dir}ping2.log
    if [ $? -eq 1 ];then
        STAT=`cat ${dir}ping.lock`
        if [ ${STAT} -eq 1 ];then
            /usr/bin/python /DATA/oracle/netdir/GFweixin.py xuel GLP-VPN &quot;GLP from PDC(172.16.6.1
50) ping 金融云(10.75.128.8)中断，请检查深信服VPN！ \n TIME:${data1}&quot;            echo 0 &gt; ${dir}ping.lock
        else
            continue
        fi
    else
        STAT=`cat ${dir}ping.lock`
        if [ ${STAT} -eq 0 ];then
            /usr/bin/python /DATA/oracle/netdir/GFweixin.py xuel GLP-VPN &quot;GLP from PDC(172.16.6.1
50) ping 金融云(10.75.128.8)恢复！ \n TIME:${data1}&quot;          echo 1 &gt; ${dir}ping.lock
        else
            continue
        fi
    fi


done
</pre></div>
</div>
<p>文件处理</p>
<p>eg3:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#function:check url
filename=urllist.txt
cat $filename | while read url;do
status=`curl -I $url -s|awk &#39;/HTTP/{print $2}&#39;`
if [ $status == &quot;200&quot; ];then
        echo &quot;Url:$url is ok!status is $status&quot;
else
        echo &quot;Url:$url is error!status is $status&quot;
fi
done
</pre></div>
</div>
<p>或</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#function:check url
filename=urllist.txt
while read url;
do
status=`curl -I $url -s|awk &#39;/HTTP/{print $2}&#39;`
if [ $status == &quot;200&quot; ];then
        echo &quot;Url:$url is ok!status is ${status}&quot;
else
        echo &quot;Url:$url is error!status is ${status}&quot;
fi
done &lt;$filename
</pre></div>
</div>
</div>
<div class="section" id="break-continue">
<h2><a class="toc-backref" href="#id113">四、break 和 continue 语句</a><a class="headerlink" href="#break-continue" title="Permalink to this headline">¶</a></h2>
<p>break跳出循环</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash

N=0
while true; do
    let N++
    if [ $N -eq 5 ]; then
    break
    fi
    echo $N
done
</pre></div>
</div>
<p>continue</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
N=0
while [ $N -lt 5 ]; do
    let N++
    if [ $N -eq 3 ]; then
        continue
    fi
    echo $N
done
</pre></div>
</div>
</div>
<div class="section" id="case">
<h2><a class="toc-backref" href="#id114">五、case语句</a><a class="headerlink" href="#case" title="Permalink to this headline">¶</a></h2>
<p>语句</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">case</span> <span class="n">模式名</span>    <span class="ow">in</span>
    <span class="n">模式</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">命令</span>
        <span class="p">;;</span>
    <span class="n">模式</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">命令</span>
        <span class="p">;;</span>
    <span class="o">*</span><span class="p">)</span>
        <span class="n">不符合以上模式执行的命令</span>
<span class="n">esac</span>
</pre></div>
</div>
<p>eg</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
case $1 in
    start)
        echo &quot;start.&quot;
        ;;
    stop)
        echo &quot;stop.&quot;
        ;;
    restart)
        echo &quot;restart.&quot;
        ;;
    *)
        echo &quot;Usage: $0 {start|stop|restart}&quot;
esac
</pre></div>
</div>
</div>
</div>
<div class="section" id="id36">
<h1><a class="toc-backref" href="#id115">五、函数</a><a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id37">
<h2><a class="toc-backref" href="#id116">一、概念</a><a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h2>
<p>linux shell
可以用户定义函数，然后在shell脚本中可以随便调用,以此来重复调用公共函数，减少代码量。</p>
</div>
<div class="section" id="id38">
<h2><a class="toc-backref" href="#id117">二、格式</a><a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span> <span class="n">function</span> <span class="p">]</span> <span class="n">funname</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">action</span><span class="p">;</span>
    <span class="p">[</span><span class="k">return</span> <span class="nb">int</span><span class="p">;]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>说明：</p>
<ul class="simple">
<li>function 关键字可写，也可不写。</li>
<li>参数返回，可以显示加：return返回，如果不加，将以最后一条命令运行结果，作为返回值。
return后跟数值n(0-255）,hell
函数返回值只能是整形数值，一般是用来表示函数执行成功与否的，0表示成功，其他值表示失败。因而用函数返回值来返回函数执行结果是不合适的。如果要硬生生地return某个计算结果，比如一个字符串，往往会得到错误提示：“numeric
argument required”。
如果一定要让函数返回一个或多个值，可以定义全局变量，函数将计算结果赋给全局变量，然后脚本中其他地方通过访问全局变量，就可以获得那个函数“返回”的一个或多个执行结果了。</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
function output_data() {
    DATA=$((1+1))
    return $DATA
}
output_data
echo $?
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
# function:add number
function add_num() {
    echo &quot;请输入第一个数：&quot;
    read number01
    echo &quot;请输入第二个数字&quot;
    read number02
    if [[ &quot;$number01&quot; =~ ^[0-9]+$ ]] &amp;&amp; [[ &quot;$number02&quot; =~ ^[0-9]+$ ]];then
        sum=$(($number01+$number02))
        echo &quot;$number01 + $number02 = $sum&quot;
    else
        echo &quot;input must be number&quot;
    fi
}
add_num
</pre></div>
</div>
</div>
<div class="section" id="id39">
<h2><a class="toc-backref" href="#id118">三、函数参数</a><a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h2>
<p>将函数写成无状态的，将数据当做参数进行传入</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
funWithParam(){
    echo &quot;第一个参数为 $1 !&quot;
    echo &quot;第二个参数为 $2 !&quot;
    echo &quot;第十个参数为 $10 !&quot;
    echo &quot;第十个参数为 ${10} !&quot;
    echo &quot;第十一个参数为 ${11} !&quot;
    echo &quot;参数总数有 $# 个!&quot;
    echo &quot;作为一个字符串输出所有参数 $* !&quot;
    echo &quot;作为一个字符串输出所有参数 $@ !&quot;

}
funWithParam `seq 1 20`
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>${1..n} 指定第n个输入的变量名称
$0      脚本自身名字

$?      返回上一条命令是否执行成功，0 为执行成功，非 0 则为执行失败

$#      位置参数总数

$*      所有的位置参数被看做一个字符串

$@      每个位置参数被看做独立的字符串

$$      当前进程 PID

$!      上一条运行后台进程的 PID
</pre></div>
</div>
<p>eg:函数炸弹</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">:(){</span> <span class="p">:</span><span class="o">|</span><span class="p">:</span><span class="o">&amp;</span> <span class="p">};:</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name"><a href="#id40"><span class="problematic" id="id41">|</span></a>:</th><td class="field-body">表示每次调用函数“:”的时候就会生成两份拷贝。</td>
</tr>
</tbody>
</table>
<p>&amp; 放到后台</p>
<p>递归调用自身，直至系统崩溃</p>
</div>
</div>
<div class="section" id="id42">
<h1><a class="toc-backref" href="#id119">六、正则表达式</a><a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id43">
<h2><a class="toc-backref" href="#id120">一、基本正则表达式</a><a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id44">
<h3><a class="toc-backref" href="#id121">1.1 字符匹配</a><a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>.:匹配任意单个字符</li>
<li></li>
<li>[^]:匹配指定范围外的任意单个字符</li>
<li>[:digit:]匹配元字符</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>posix字符
[:alnum:] 字母数字[a-z A-Z 0-9]
[:alpha:]字母[a-z A-Z]
[:blank:]空格或制表键
[:cntrl:] 任何控制字符
[:digit:] 数字 [0-9]
[:graph:] 任何可视字符（无空格）
[:lower:] 小写 [a-z]
[:print:] 非控制字符
[:punct:] 标点字符
[:space:] 空格
[:upper:] 大写 [A-Z]
[:xdigit:] 十六进制数字 [0-9 a-f A-F]
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>特殊字符
\w 匹配任意数字和字母，等效[a-zA-Z0-9_]
\W 和\w相反，等效[^a-zA-Z0-9_]
\b 匹配字符串开始或结束，等效\&lt;和\&gt;
\s 匹配任意的空白字符
\S 匹配非空白字符
</pre></div>
</div>
</div>
<div class="section" id="id45">
<h3><a class="toc-backref" href="#id122">1.2 次数匹配</a><a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<p>用在制定的字符后面，表示制定前面的字符出现多少次 *
*:匹配前面的字符任意次（0次获无数次） * ?:匹配前面的字符0次或1次 *
+:匹配前面的字符至少1次 *
{m,}:匹配前面的字符至少m次（默认工作在贪婪模式下，?取消贪婪模式） *
{m,n}:匹配前面的字符至少m次，至多n次 eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.*</span><span class="p">:</span><span class="n">匹配任意字符任意次数</span>
</pre></div>
</div>
</div>
<div class="section" id="id46">
<h3><a class="toc-backref" href="#id123">1.3 位置锚定</a><a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>^:行首锚定，用于模式最左边</li>
<li>$:行尾锚定,用于模式最右边</li>
<li>\&lt;或:raw-latex:<cite>b</cite>:锚定词首，用于单词模式左侧</li>
<li>\&gt;或:raw-latex:<cite>b</cite>:锚定词尾，用于单词模式右侧</li>
</ul>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>^$:锚定空行
</pre></div>
</div>
</div>
<div class="section" id="id47">
<h3><a class="toc-backref" href="#id124">1.4 分组引用</a><a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h3>
<p>分组 * ():将一个或多个字符当成一个整体来进行后续处理</p>
<p>引用 *
1：从左侧起，引用第一个左括号以及与之匹配右括号之间的模式所匹配到的字符，后向引用</p>
<p>exercises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1.显示/etc/init.d/functions文件中以大小s开头的行(使用两种方式)
grep &#39;^[Pp]&#39; /etc/init.d/functions
grep -i &quot;^p&quot; /etc/init.d/functions

2.显示/etc/passwd文件中不以/bin/bash结尾的行
grep -v &quot;/bin/bash$&quot; /etc/passwd

3.显示/etc/passwd文件中ID号最大用户的用户名
sort -t: -k3 -n /etc/passwd |tail -1 |cut -d: -f1

4.如果root用户存在,显示其默认的shell程序
id root &amp;&amp; grep &#39;^\&lt;root\&gt;&#39; /etc/passwd |awk -F: &#39;{print $NF}&#39;

5.找出/etc/passwd中的两位或三位数
grep -o -E &quot;[0-9]{2,3}&quot; /etc/passwd
grep -o &quot;[0-9]\{2,3\}&quot; /etc/passwd

6.显示/etc/rc.d/rc.sysinit文件中,至少以一个空白字符开头的且后面存非空白字符的行:
grep &#39;^[[:space:]]\+[^[:space:]]&#39; /etc/rc.d/rc.sysinit


7.找出&quot;netstat -tan&quot;命令的结果以&quot;LISTEN&quot;后跟0,1或多个空白字符结尾的行
netstat -tan|grep &#39;LISTEN[[:space:]]*$&#39;

8.如果root用户登录了系统,就显示root用户在线,否则说明未登录
w |grep &#39;^\&lt;root\&gt;&#39;&gt;/dev/null &amp;&amp; echo &quot;root在线&quot;|| echo &quot;root未登录&quot;

9.找出/etc/rc.d/init.d/functions文件中某单词后面跟一对小括号的行
grep &#39;[[:alpha:]]*()&#39; /etc/rc.d/init.d/functions

10.使用echo输出一个路径,使用egrep取出基名
 echo /tmp/tmp1/vmstat.8.gz |grep -E  -o &#39;[^/]+/?$&#39;|cut -d/ -f1
echo /tmp/tmp1/vmstat.8.gz |awk -F&#39;/&#39; &#39;{print $NF}&#39;

11.匹配PPID开头，行中又再次出现PPID的内容。/etc/init.d/functions
grep -E &quot;(PPID).*\1&quot; /etc/init.d/functions

12.利用awk找出/etc/ssh/sshd_config内出过空行与以#开头的行
awk &#39;!/^#/ &amp;&amp; !/^$/{print}&#39; /etc/ssh/sshd_config
grep -v -E &#39;^#|^$&#39; /etc/ssh/sshd_config
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="grep">
<h1><a class="toc-backref" href="#id125">七、三剑客之grep</a><a class="headerlink" href="#grep" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id48">
<span id="id49"></span><h2><a class="toc-backref" href="#id126">一、概念</a><a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h2>
<p>grep (global search regular expression(RE) and print out the
line,全面搜索正则表达式并把行打印出来)是一种强大的文本搜索工具，它能使用正则表达式搜索文本，并把匹配的行打印出来。egrep是grep的扩展，支持更多的re元字符，
fgrep就是fixed grep或fast
grep，它们把所有的字母都看作单词，也就是说，正则表达式中的元字符表示回其自身的字面意义，不再特殊。linux使用GNU版本的grep。它功能更强，可以通过-G、-E、-F命令行选项来使用egrep和fgrep的功能。</p>
</div>
<div class="section" id="id50">
<h2><a class="toc-backref" href="#id127">二、语法格式</a><a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h2>
<p>grep [OPTION]… PATTERN [FILE]</p>
<div class="section" id="id51">
<h3><a class="toc-backref" href="#id128">2.1 选项</a><a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">-i：忽略大小写</p>
</li>
<li><p class="first">-c:统计匹配到字符串的次数</p>
</li>
<li><p class="first">-n:顺便输出行号</p>
</li>
<li><p class="first">-v:反向选择，显示没有匹配到的内容</p>
</li>
<li><p class="first">-o：只显示匹配到的串</p>
</li>
<li><p class="first">-A:显示匹配到的字符后面的n行</p>
</li>
<li><p class="first">-B:显示匹配到的字符前面的n行</p>
</li>
<li><p class="first">-C:显示前后各n行</p>
</li>
<li><p class="first rubric" id="id52">2.2 模式</p>
</li>
<li><p class="first">基本正则表达式元字符：</p>
</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">.</span> <span class="p">:</span><span class="n">匹配任意单个字符</span>
<span class="p">[]</span> <span class="p">:</span><span class="n">匹配指定范围内的字符</span>
<span class="p">[</span><span class="o">^</span><span class="p">]:</span><span class="n">匹配指定范围外的任意字符</span>
</pre></div>
</div>
<ul class="simple">
<li>次数匹配（贪婪模式）</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>*：匹配其前的字符0，1或者多次
？：匹配其前的字符0或1次
\{m,n\}:
    \(m,\):至少m次
    \{0,n\}:至多n次
    \{m\}:m次
</pre></div>
</div>
<ul class="simple">
<li>锚定符：</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>r..t  ：root  chroot
* 单词锚定：
\&lt;:锚定词首：\&lt;r..t,    \b
\&gt;:锚定词尾：root\&gt;
* 行首行末锚定：
^: ^root,  行首
$:    root$ 行尾
.*:  任意长度的任意字符
</pre></div>
</div>
<ul class="simple">
<li>分组： () (abc)</li>
<li>引用：</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\1 :后向引用，引用前面的第一个左括号与与之对应的右括号中的模式所匹配到的内容
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dmesg</span> <span class="o">|</span><span class="n">grep</span> <span class="o">-</span><span class="n">n</span> <span class="n">eth0</span>
<span class="n">grep</span> <span class="o">-</span><span class="n">E</span> <span class="s1">&#39;/.{2,3}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<p>取掉空行</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grep</span> <span class="o">-</span><span class="n">E</span> <span class="o">-</span><span class="n">v</span> <span class="s2">&quot;^$|^#&quot;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">conf</span><span class="o">/</span><span class="n">httpd</span><span class="o">.</span><span class="n">conf</span>
</pre></div>
</div>
<p>查看mysql中的库</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$(mysql -uroot -p&#39;passwd&#39; -e &quot;show databases;&quot;|egrep -v &#39;Database|^test|mysql|performance_schema|information_schema&#39;)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="sed">
<h1><a class="toc-backref" href="#id129">八、三剑客之sed</a><a class="headerlink" href="#sed" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id53">
<span id="id54"></span><h2><a class="toc-backref" href="#id130">一、概念：</a><a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h2>
<p>sed是一种流编辑的文本处理工具， *
工作模式：将当前处理的行存储在临时缓冲区（模式空间），对缓冲区中的内容利用制定的动作进行处理，完成后输出到屏幕，接着反复重复执行此操作完成整改文件的处理。
* ## 二、适用场景</p>
<ul class="simple">
<li>大文件</li>
<li>有规律的文本</li>
</ul>
</div>
<div class="section" id="id55">
<h2><a class="toc-backref" href="#id131">三、语法</a><a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h2>
<p>sed [option] ‘Addresscommand’ [file …]</p>
<ul>
<li><p class="first">选项</p>
<ul>
<li><p class="first">-n:安静模式，仅显示script处理后的结果，不再默认显示模式空间中的内容</p>
</li>
<li><p class="first">-e:</p>
<script><p>或–expression=</p>
<script><p>以选项中指定的script来处理输入的文本文件，可以同时执行多个脚本</p>
</li>
<li><p class="first">-f:对制定的文件直接进行sed的command操作</p>
</li>
<li><p class="first">-i:直接修改原文件</p>
</li>
<li><p class="first">-r:支持扩展正则表达式</p>
</li>
</ul>
</li>
<li><p class="first">地址定界</p>
<ul class="simple">
<li>startline，endline</li>
<li>/regexp/</li>
<li>/pattern1/,/pattern2/:第一次被pattern1匹配到的行开始，直到被pattern2匹配到的行结束</li>
<li>linenuber：制定行号</li>
<li>startline，+n，从startline开始，向后n行结束</li>
<li>startline~step:步长，每隔step步</li>
</ul>
</li>
<li><p class="first">命令操作</p>
<ul class="simple">
<li>d: 删除符合条件的行；</li>
<li>p: 显示符合条件的行；</li>
<li>a :
在制定或匹配到的行后面追加新行，内容为string</li>
<li>：可以用于换行</li>
<li>i :
在制定或匹配到的行前面添加新行，内容为string</li>
<li>s:s/pattern/string/修饰符:
查找并替换，默认只替换每行中第一次被模式匹配到的字符串 加修饰符</li>
<li>g: 全局替换</li>
<li>i: 忽略字符大小写</li>
</ul>
</li>
<li><p class="first">匹配元字符：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>^ 匹配行开始，如：/^sed/匹配所有以sed开头的行。
$ 匹配行结束，如：/sed$/匹配所有以sed结尾的行。
. 匹配一个非换行符的任意字符，如：/s.d/匹配s后接一个任意字符，最后是d。
* 匹配0个或多个字符，如：/*sed/匹配所有模板是一个或多个空格后紧跟sed的行。
[] 匹配一个指定范围内的字符，如/[ss]ed/匹配sed和Sed。
[^] 匹配一个不在指定范围内的字符，如：/[^A-RT-Z]ed/匹配不包含A-R和T-Z的一个字母开头，紧跟ed的行。
\(..\) 匹配子串，保存匹配的字符，如s/\(love\)able/\1rs，loveable被替换成lovers。
&amp; 保存搜索字符用来替换其他字符，如s/love/**&amp;**/，love这成**love**。
\&lt; 匹配单词的开始，如:/\&lt;love/匹配包含以love开头的单词的行。
\&gt; 匹配单词的结束，如/love\&gt;/匹配包含以love结尾的单词的行。
x\{m\} 重复字符x，m次，如：/0\{5\}/匹配包含5个0的行。
x\{m,\} 重复字符x，至少m次，如：/0\{5,\}/匹配至少有5个0的行。
x\{m,n\} 重复字符x，至少m次，不多于n次，如：/0\{5,10\}/匹配5~10个0的行。
</pre></div>
</div>
</li>
</ul>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1、删除/etc/grub.conf文件中行首的空白符；
sed -r &#39;s/^[[:space:]]+//g&#39; /etc/grub.conf
2、替换/etc/inittab文件中&quot;id:3:initdefault:&quot;一行中的数字为5；
&#39;s/id:[0-9]/id:5/g&#39; /etc/inittab
3、删除/etc/inittab文件中注释行：
sed &#39;/^#/d&#39; /etc/inittab
4、取消/etc/inittab文件中开头的#号;
sed &#39;s/^#//g&#39; /etc/inittab
5、打印文件/etc/services匹配blp5开头的行
sed -n &#39;/^blp5/p&#39; /etc/services
6、打印2-5行
sed -n &#39;2,5p&#39; /etc/services
7、打印奇数行
seq 10 |sed -n &#39;1~2p&#39;
8、打印最后一行
sed &#39;$p&#39; /etc/services
</pre></div>
</div>
</div>
</div>
<div class="section" id="awk">
<h1><a class="toc-backref" href="#id132">九、三剑客之awk</a><a class="headerlink" href="#awk" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id56">
<span id="id57"></span><h2><a class="toc-backref" href="#id133">一、概念</a><a class="headerlink" href="#id56" title="Permalink to this headline">¶</a></h2>
<p>AWK：报告生成器，格式化文本输出工具</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="s1">&#39;script&#39;</span> <span class="n">file1</span><span class="p">,</span><span class="n">file2</span><span class="o">...</span>
<span class="n">awk</span> <span class="p">[</span><span class="n">options</span><span class="p">]</span> <span class="s1">&#39;PATTERN </span><span class="si">{action}</span><span class="s1">&#39;</span> <span class="n">file1</span><span class="p">,</span><span class="n">file2</span>
</pre></div>
</div>
<ul>
<li><p class="first">处理机制：一次从文件中读取出来一行，按照特定分隔符对其进行切片（默认空格）</p>
</li>
<li><p class="first">步骤：</p>
<ul class="simple">
<li>读( Read )：AWK
从输入流（文件、管道或者标准输入）中读入一行然后将其存入内存中。</li>
<li>执行(Execute)：对于每一行输入，所有的 AWK 命令按顺执行。
默认情况下，AWK
命令是针对于每一行输入，但是我们可以将其限制在指定的模式中。</li>
<li>重复（Repeate）：一直重复上述两个过程直到文件结束。</li>
</ul>
</li>
<li><p class="first">程序结构：</p>
<ul class="simple">
<li>开始块（BEGIN BLOCK）：</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>语法：
BEGIN{awk-commands}
开始块就是awk程序启动时执行的代码部分（在处理输入流之前执行），并且在整个过程中只执行一次；一般情况下，我们在开始块中初始化一些变量。BEGIN是awk的关键字，因此必须要大写。【注：开始块部分是可选，即你的awk程序可以没有开始块部分】
</pre></div>
</div>
<ul class="simple">
<li>主体块（Body Block）：</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>语法：
/pattern/{awk-commands}
针对每一个输入的行都会执行一次主体部分的命令，默认情况下，对于输入的每一行，awk都会执行主体部分的命令，但是我可以使用/pattern/限制其在指定模式下。
</pre></div>
</div>
<ul class="simple">
<li>结束块（END BLOCK）：</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>语法：
END{awk-commands}
结束块是awk程序结束时执行的代码（在处理完输入流之后执行），END也是awk的关键字，必须大写，与开始块类似，结束块也是可选的。
</pre></div>
</div>
</li>
</ul>
<div class="section" id="id58">
<h3><a class="toc-backref" href="#id134">1.1 awk输出</a><a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ol class="arabic simple">
<li>print 使用格式</li>
</ol>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">item1</span><span class="p">,</span><span class="n">item2</span><span class="o">...</span>
</pre></div>
</div>
<p><strong>要点:</strong> * 1.各字段之间逗号隔开，输出时以空白字符分割；</p>
<ul class="simple">
<li>2.输出的字段可以为字符串或数值，当前记录的字段（如$1）、变量或awk的表达式；数值先回转换成字符串然后输出</li>
<li>3.print命令后面的item可以省略，此时其功能相当于print
$0,如果想输出空白，可以使用<code class="docutils literal notranslate"><span class="pre">print</span> <span class="pre">&quot;&quot;</span></code></li>
</ul>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{print $1,$NF}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span><span class="o">|</span><span class="n">column</span> <span class="o">-</span><span class="n">t</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tail</span> <span class="o">-</span><span class="mi">1</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span><span class="o">|</span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;BEGIN{OFS=&quot;#&quot;}{print “hello”$1,$2}&#39;</span>
</pre></div>
</div>
<blockquote>
<div>2.printf</div></blockquote>
<p>printf命令的使用格式:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">printf</span> <span class="o">&lt;</span><span class="nb">format</span><span class="o">&gt;</span> <span class="n">item1</span><span class="p">,</span><span class="n">item2</span><span class="o">...</span>
</pre></div>
</div>
<p><strong>要点：</strong> * 1.其与print命令最大区别,printf
需要指定format,format必须给出</p>
<ul class="simple">
<li>2.format用于指定后面的每个item输出格式</li>
<li>3.printf 语句不会自动打印换行字符:</li>
</ul>
<p>format格式的指示符都以%开头，后跟一个字符:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>%c:显示ascall码
%d:%i:十进制整数
%e，%E：科学计数法
%f:浮点数
%s：字符串
%u：无符号整数
%%：显示%自身

修饰符：
#[.#]:第一个#控制显示的宽度：第二个#表示小数点后的精度：

%3.1f

-:左对齐
+：显示数组符号
</pre></div>
</div>
<p>eg：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{printf &quot;Username:</span><span class="si">%-15s</span><span class="s1">   ,Uid:</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&quot;,$1,$3}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
</div>
<div class="section" id="id59">
<h3><a class="toc-backref" href="#id135">1.2 awk变量</a><a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">awk内置变量之记录变量：</p>
<ul class="simple">
<li>FS:field separator，输入字段分隔符（默认空白）</li>
<li>OFS:output field separator，输出字段分隔符</li>
<li>RS:Record separator:输入文本换行符（默认回车）</li>
<li>ORS:输出文本换行符</li>
</ul>
</li>
<li><p class="first">awk内置变量之数据变量</p>
<ul class="simple">
<li>NR:the number of input
records,awk命令所处理的文件的行数，如果有多个文件，这个数目会将处理的多个文件计数</li>
<li>NF:number of field,当前记录的field个数</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{print NF},{print $NF}
</pre></div>
</div>
<ul class="simple">
<li>ARGV:数组，保存命令行本身这个字符串，</li>
<li>ARGC：awk命令的参数个数</li>
<li>FILENAME:awk命令处理的文件名称</li>
<li>ENVIRON：当前shell环境变量及其值的关联数组</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{print ENVIRON[&quot;PATH&quot;]}&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">自定义变量 -v var=value</p>
<p>变量名区分大小写</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">v</span> <span class="n">test</span><span class="o">=</span><span class="s2">&quot;abc&quot;</span> <span class="s1">&#39;BEGIN{print test}&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{var=&quot;name&quot;;print var}&#39;</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id60">
<h3><a class="toc-backref" href="#id136">1.3 操作符</a><a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">算术运算</p>
<ul class="simple">
<li>+,-,*,/,^,%</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">awk</span> <span class="pre">'BEGIN{a=5;b=3;print</span> <span class="pre">&quot;a</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">=&quot;,a+b}'</span></code></p>
</li>
<li><p class="first">字符串操作</p>
<ul class="simple">
<li>无符号操作符，表示字符串连接</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN { str1=&quot;Hello,&quot;; str2=&quot;World&quot;; str3 = str1 str2; print str3 }&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">赋值操作符：</p>
<ul class="simple">
<li>=，+=，-=，<a href="#id61"><span class="problematic" id="id62">*</span></a>=，/=，%=，^=</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{a=5;b=6;if(a == b) print &quot;a == b&quot;;else print &quot;$a!=b&quot;}&#39;</span>

<span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{sum+=$3}END{print sum}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
</li>
<li><p class="first">比较操作符：</p>
<ul class="simple">
<li>&gt;,&gt;=,&lt;,&lt;=,!=,==</li>
</ul>
</li>
<li><p class="first">模式匹配符：</p>
<ul class="simple">
<li>~:是否匹配</li>
<li>!~:是否不匹配</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;$1~&quot;root&quot;{print $0}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
</li>
<li><p class="first">逻辑操作符：</p>
<ul class="simple">
<li>&amp;&amp; 、 || 、 ！</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{a=6;if(a &gt; 0 &amp;&amp; a &lt;= 6) print &quot;true&quot;;else print &quot;false&quot;}&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">函数调用：</p>
<ul class="simple">
<li>function_name(argu1,augu2)</li>
</ul>
</li>
<li><p class="first">条件表达式(三元运算):</p>
<ul class="simple">
<li>selection？if-true-expresssion：if-false-expression</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{$3&gt;=100?usertype=&quot;common user&quot;:usertype=&quot;sysadmin&quot;;printf &quot;</span><span class="si">%15s</span><span class="s1">:</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&quot;,$1,usertype}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="pattern">
<h3><a class="toc-backref" href="#id137">1.4 Pattern</a><a class="headerlink" href="#pattern" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">empty:空模式，匹配每一行</p>
</li>
<li><p class="first">/regular expression/:仅处理能被此处模式匹配到的行</p>
</li>
<li><p class="first">relational
expression：关系表达式，结果为“真”有“假”，结果为“真”才会被处理,注意：使用模式需要使用双斜线括起来</p>
<ul class="simple">
<li>真：结果为非0值，非空字符串</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;$3&gt;100{print $1,$3}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;$NF==&quot;/bin/bash&quot;{printf &quot;</span><span class="si">%15s</span><span class="s1">,</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&quot;,$NF,$1}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;$NF~/bash$/{printf &quot;</span><span class="si">%15s</span><span class="s1">,</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&quot;,$NF,$1}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">-</span><span class="n">Th</span><span class="o">|</span><span class="n">awk</span> <span class="s1">&#39;/^\/dev/</span><span class="si">{print}</span><span class="s1">&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">line ranges：行范围，制定startline，endline</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;/10/,/20/{print $1}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;(NR&gt;2&amp;&amp;NR&lt;=10){print $1}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
</li>
<li><p class="first">BEGIN/END模式</p>
<ul class="simple">
<li>BEGIN{}：仅在开始处理喂奶姐中的文本之前执行一次</li>
<li>END{}:仅在文本处理完成之后执行一次</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;BEGIN{print &quot;username     uid</span><span class="se">\n</span><span class="s1">--------------------&quot;}{printf &quot;</span><span class="si">%-15s</span><span class="s1">:</span><span class="si">%d</span><span class="se">\n</span><span class="s1">&quot;,$1,$3}END{print &quot;-----------------</span><span class="se">\n</span><span class="s1">e</span>
<span class="n">nd</span><span class="s2">&quot;}&#39; /etc/passwd</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="action">
<h3><a class="toc-backref" href="#id138">1.5 常用action</a><a class="headerlink" href="#action" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Expression</li>
<li>Control statements<ul>
<li>if/while</li>
</ul>
</li>
<li>Compound statements</li>
<li>input statements</li>
<li>output statements</li>
</ul>
</div>
<div class="section" id="id63">
<h3><a class="toc-backref" href="#id139">1.6 控制语句</a><a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">if(condition) {statements}</p>
</li>
<li><p class="first">if(condition) {statments} [else {statments}]</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{if($3&gt;100) print $1,$3}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{if($3&gt;100) {printf &quot;Common user:</span><span class="si">%-15s</span><span class="se">\n</span><span class="s1">&quot;,$1} else {printf &quot;sysadmin user:</span><span class="si">%-15s</span><span class="se">\n</span><span class="s1">&quot;,$1}}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{if($NF==&quot;/bin/bash&quot;) print $1,$NF}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="o">-</span><span class="n">F</span><span class="p">:</span> <span class="s1">&#39;{if($NF&gt;7) print}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
</pre></div>
</div>
</li>
<li><p class="first">while(conditon) {statments}</p>
<ul class="simple">
<li>条件为“真”，进入循环，条件为“假”，退出循环</li>
<li>使用场景：对一行内的多个字段逐一类似处理时使用，对数组内的各元素逐一进行处理时使用</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;/^[[:space:]]*if/{i=1;while(i&lt;=NF) {print $i,length($i);i++}}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">functions</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;/^[[:space:]]*if/{i=1;while(i&lt;NF) {if(length($i)&gt;7) {print $i,length($i)};i++}}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">functions</span>
</pre></div>
</div>
</li>
<li><p class="first">do {statements} while(condition)</p>
<ul class="simple">
<li>意义：至少执行一次循环体</li>
</ul>
</li>
<li><p class="first">for(expr1;expr2;expr3) {statements}</p>
<ul class="simple">
<li>语法：for(variable assignment;condition;iteration process)
{for-body}</li>
<li>特殊用法：能够遍历数组中的元素，<code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">(var</span> <span class="pre">in</span> <span class="pre">array)</span> <span class="pre">{for-body}</span></code></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;/^[[:space:]]*if/{for(i=1;i&lt;NF;i++) {print $i,length($i)}}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">functions</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;/^[[:space:]]*if/{for(i=1;i&lt;NF;i++) {if(length($i)&gt;7) print $i,length($i)}}&#39;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">functions</span>
</pre></div>
</div>
</li>
<li><p class="first">break</p>
</li>
<li><p class="first">continue</p>
</li>
<li><p class="first">delete array[index]</p>
</li>
<li><p class="first">switch语句</p>
<ul class="simple">
<li>语法：switch(expression) {case VALUE1 or /REGEXP/: statement; case
VALUE2 VALUE2 or /EXGEXP2/: statement;…;default: statement}</li>
</ul>
</li>
</ul>
<div class="section" id="array">
<h4>1.6 array<a class="headerlink" href="#array" title="Permalink to this headline">¶</a></h4>
<ul>
<li><p class="first">关联数组：</p>
<ul>
<li><p class="first">array[index-expression]</p>
<ul>
<li><p class="first">index-pression:</p>
<ul class="simple">
<li>任意字符串</li>
<li>如果某数组元素事先不存在，引用时候，awk自动创建此元素，并将其值初始化为空串，若要判断数组中是否存在某元素，需要使用<code class="docutils literal notranslate"><span class="pre">index</span> <span class="pre">in</span> <span class="pre">array</span></code>格式进行</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{weekdays[&quot;mon&quot;]=&quot;Monday&quot;;weekdays[&quot;tue&quot;]=&quot;Tuesday&quot;;print weekdays[&quot;tue&quot;]}&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">遍历数组使用for循环</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">for(var</span> <span class="pre">in</span> <span class="pre">array)</span> <span class="pre">{do-body}</span></code></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{weekdays[&quot;mon&quot;]=&quot;Monday&quot;;weekdays[&quot;tue&quot;]=&quot;Tuesday&quot;;for(i in weekdays) print weekdays[i]}&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li>注意：var会遍历array的每个索引：</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">netstat</span> <span class="o">-</span><span class="n">tan</span><span class="o">|</span><span class="n">awk</span> <span class="s1">&#39;/^tcp/{state[$NF]++}END{for(i in state) print i,state[i]}&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;{ips[$1]++}END{for(i in ips){printf &quot;</span><span class="si">%-5d</span><span class="s1">,</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&quot;,ips[i],i}}&#39;</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">log</span><span class="o">/</span><span class="n">httpd</span><span class="o">/</span><span class="n">access_log</span><span class="o">-</span><span class="mi">20180916</span> <span class="o">|</span><span class="n">sort</span> <span class="o">-</span><span class="n">k1</span> <span class="o">-</span><span class="n">nr</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="id64">
<h3><a class="toc-backref" href="#id140">1.7 函数</a><a class="headerlink" href="#id64" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">内置函数</p>
<ul>
<li><p class="first">数值处理： rand():返回0和1之间的一个随机数</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">awk</span> <span class="s1">&#39;BEGIN{print rand()}&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">字符串处理： length([s]):返回制定字符串的长度
sub(r,s,[t])：以r表示的模式来查找t所表示的字符串中匹配到的内容，并将其第一次出现替换为s所表示的那日</p>
</li>
</ul>
</li>
</ul>
<p>exercises:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* 统计/etc/fstab文件中每个单词出现的次数，并按从大到小排序
awk &#39;{for(i=1;i&lt;=NF;i++){words[$i]++}}END{for(key in words)print key,words[key]}&#39; /etc/fstab|sort -k2 -nr

awk &#39;{ips[$1]++}END{for(i in ips) print i,ips[i]}&#39; access_nginx.log |column -t|sort -k2 -nr

* 统计/etc/fstab每个文件系统类型出现的次数
awk &#39;!/^#/&amp;&amp;!/^$/{dev[$3]++}END{for(i in dev) print i,dev[i]}&#39; /etc/fstab

* ping一个域名，输出ping此刻的时间
ping baidu.com|awk &#39;{print $0&quot; &quot;strftime(&quot;%Y-%m-%d %H:%M:%S&quot;)}&#39;

* 利用netstat监控服务是否正常监听
netstat -lntup|awk &#39;NR&gt;2{if($4 ~/.*:22/) print $0&quot;yes&quot;;exit 0}&#39;

* 统计web服务器日志状态码
awk &#39;$9~&quot;[0-9]&quot;{stat[$9]++}END{for(i in stat) print i,stat[i]}&#39; access_log
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id65">
<h1><a class="toc-backref" href="#id141">十、shell杂项</a><a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id66">
<h2><a class="toc-backref" href="#id142">一、输入输出</a><a class="headerlink" href="#id66" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>输入输出 文件描述符 | 描述 | 映射关系 —<a href="#id68"><span class="problematic" id="id69">|—|</span></a>— 0 | 标准输入 |
/dev/stdin -&gt; /proc/self/fd/0 1 | 标准输出 | /dev/stdout -&gt;
/proc/self/fd/1 2 | 标准错误 | /dev/stderr -&gt; /proc/self/fd/2</li>
<li>重定向</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&gt; ：符号左边输出作为右边的输入
&gt;&gt;: 符号左边输出追加右边的输入
&lt; : 符号右边输出作为左边输入（标准输入）
&lt;&lt;: 符号右边输出追加左边输入
&amp; : 重定向绑定符号
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">&gt;</span> <span class="n">file</span><span class="o">.</span><span class="n">txt</span> <span class="o">&lt;&lt;</span><span class="n">EOF</span>
<span class="n">context</span>
<span class="n">EOF</span>

<span class="n">ls</span> <span class="n">aa</span> <span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="id67">
<h2><a class="toc-backref" href="#id143">命令</a><a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>tac:倒序打印文件</li>
<li>rev反向打印每一行</li>
<li>cut:字符切割，常用选项-d 分割，-f输出第几段</li>
<li>tr:替换或删除字符</li>
<li>seq:打印序列化数字</li>
<li>sort:排序 -t:制定分隔符 -k:制定field -r:倒序排序 -u:去重行</li>
<li>uniq:去重 -c 打印出现次数、-u ：打印不重复的行</li>
<li>date:显示系统时间</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>时间加减：
显示前 30 秒：date -d &#39;-30 second&#39; +&#39;%F %T&#39;
显示前一分钟：date -d &#39;-1 minute&#39; +&#39;%F %T&#39;
显示前一个时间：date -d &#39;-1 hour&#39; +&#39;%F %T&#39;
显示前一个天：date -d &#39;-1 day&#39; +&#39;%F %T&#39;
显示上一周：date -d &#39;-1 week&#39; +&#39;%F %T&#39;
显示上一个月日期：date -d &#39;-1 month&#39; +%F
显示上一年日期：date -d &#39;-1 year&#39; +%F
或
显示前一天日期：date -d yesterday +%F
显示后一天日期：date -d tomorrow +%F
</pre></div>
</div>
<ul class="simple">
<li>screen<ul>
<li>screen -ls</li>
<li>screen -r</li>
<li>screen -wipe</li>
</ul>
</li>
</ul>
<p>脚本编写注意事项</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1）开头加解释器：#!/bin/bash

2）语法缩进，使用四个空格；多加注释说明。

3）命名建议规则：变量名大写、局部变量小写，函数名小写，名字体现出实际作用。

4）默认变量是全局的，在函数中变量 local 指定为局部变量，避免污染其他作用域。

5）有两个命令能帮助我调试脚本：set -e 遇到执行非 0 时退出脚本，set -x 打印执行过程。

6）写脚本一定先测试再到生产上。
</pre></div>
</div>
<ul class="simple">
<li>实战</li>
<li>文件扫描校验</li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
#func:scan file
#md5sum -c $SCAN_FILE


SCAN_DIR=`echo $PATH |sed &#39;s/:/ /g&#39;`
SCAN_CMD=`which md5sum`
SCAN_FILE_FALL=&quot;/tmp/scan_$(date +%F%H%m)_fall.txt&quot;
SCAN_FILE_BIN=&quot;/tmp/scan_$(date +%F%H%m)_bin.txt&quot;

scan_fall_disk() {
        echo &quot;正在全盘扫描，请稍等！文件路径:$SCAN_FILE_FALL&quot;
        find / -type f -exec $SCAN_CMD \{\} \;&gt;&gt; $SCAN_FILE_FALL 2&gt;/dev/null
}

scan_bin() {
    echo &quot;正在扫描PATH可执行文件，请稍等，文件路径：$SCAN_FILE_BIN&quot;
    for file in $SCAN_DIR
    do
        find $filae -type f -exec $SCAN_CMD \{\} \;&gt;&gt; $SCAN_FILE_BIN 2&gt;/dev/null
    done
}

main() {
    [ $# -lt 1 ] &amp;&amp; echo &quot;请使用参数，1表示全盘扫描，2表示二进制可执行文件扫描&quot;
    read number
    case $number in
    1)
        scan_fall_disk;;
    2)
        scan_bin;;
    *)
        echo &quot;参数错误，1，表示全盘扫描，2表示二进制文件扫描&quot;
    esac
}


main
</pre></div>
</div>
<p>自定义垃圾回收</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#!/bin/bash
# function:自定义rm命令，每天晚上定时清理

CMD_SCRIPTS=$HOME/.rm_scripts.sh
TRASH_DIR=$HOME/.TRASH_DIR
CRON_FILE=/var/spool/cron/root
BASHRC=$HOME/.bashrc

[ ! -d ${TRASH_DIR} ] &amp;&amp; mkdir -p ${TRASH_DIR}
cat &gt; $CMD_SCRIPTS &lt;&lt;EOF
PARA_CNT=\$#
TRASH_DIR=$TRASH_DIR

for i in \$*; do
     DATE=\$(date +%F%T)
     fileName=\$(basename \$i)
     mv \$i \$TRASH_DIR/\$fileName.\$DATE
done
EOF

sed -i &quot;s@$(grep &#39;alias rm=&#39; $BASHRC)@alias rm=&#39;bash ${CMD_SCRIPTS}&#39;@g&quot; $BASHRC
source $HOME/.bashrc

echo &quot;0 0 * * * rm -rf $TRASH_DIR/*&quot; &gt;&gt; $CRON_FILE
echo &quot;删除目录:$TRASH_DIR&quot;
echo &quot;删除脚本:$CMD_SCRIPTS&quot;
echo &quot;请执行:source $BASHRC 来加载文件或退出当前shell重新登录&quot;
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to MING’s BLOG’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright KaliArch

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>